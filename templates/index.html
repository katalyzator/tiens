{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}



    <div class="wrap-main-slider">
        <ul class="main-slider"
            style="background: url({% static 'css/images/green_diamond_patterns-wallpaper-1920x1080.jpg' %}) no-repeat center;">

            <li class="main-slider__item main-slider__item_first-bg">
                <div class="container">
                    <h1 class="main-slider__title">treat your family<br>with fresh and juicy fruits!</h1>

                    <article class="main-slider-post">
                        <div class="main-slider-post__container">
                            <h1 class="main-slider-post__title">Orange</h1>

                            <p>In an ideal world this website wouldn't exist, a client would acknowledge the importance
                                having web copy before the design starts.</p>

                            <blockquote class="main-slider-post__quote">
                                <p>Best treat when inviting friends or family!</p>
                            </blockquote>
                        </div>
                        <!-- end main slider post container -->

                        <div class="main-slider-post__image">
                            <img src="http://placehold.it/432x375/333" alt="#">

                            <div class="wrap-price">
                                <div class="price">$58</div>
                            </div>
                        </div>
                        <!-- end main slider post image -->
                    </article>
                    <!-- main slider post -->
                </div>
                {#                <!-- end container -->#}
            </li>
            <!-- end main slider item -->
        </ul>
        <!-- end main slider -->
    </div>
    <!-- end wrap main slider -->

    <div class="container">
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter">
            Launch demo modal
        </button>

        <!-- Modal -->
        <div class="modal fade bd-example-modal-lg" id="exampleModalCenter" tabindex="-1" role="dialog"
             aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="shop-item shop-item_big shop-item_ins cf">
                            <div class="shop-item__content">
                                <h1 class="shop-item__title">orange</h1>

                                <p>In an ideal world this website wouldn't exist, a client would acknowledge the
                                    importance having web copy
                                    before the design starts.</p>

                                <blockquote class="shop-item__quote">
                                    <p>Best treat when inviting friends or family!</p>
                                </blockquote>

                                <div class="shop-item__price">$56<span>$75</span></div>
                            </div>
                            <!-- end shop item content -->

                            <div class="shop-item__thumb">
                                <img src="http://placehold.it/304x263" alt="">

                                <a href="#" class="buy-btn buy-btn_round"><i class="buy-btn__icon"></i>Buy</a>
                            </div>
                            <!-- end shop item thumb -->

                            <div class="shop-item__details">
                                <div class="amount">
                                    <input type="text" value="1" size="5" class="amount__field"/>
                                    <span class="amount__btn amount__btn_minus">-</span>
                                    <span class="amount__btn amount__btn_plus">+</span>
                                </div>
                                <!-- end amount -->
                                <br>
                                <a href="#" class="buy-btn buy-btn_round"><i class="buy-btn__icon"></i>Buy</a>
                            </div>
                            <!-- end shop item detailed col -->
                        </div>
                        <!-- end shop item big -->

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="wrap-slider">
            <header class="slider-heading cf">
                {#                <div class="slider-controls">#}
                {#                    <div class="slider-controls__prev"></div>#}
                {#                    <div class="slider-controls__next"></div>#}
                {#                </div>#}
                {#                <!-- end slider controls -->#}

                <h1 class="slider-heading__title">Специальные предложения</h1>


            </header>
            <!-- end slider heading -->

            <ul class="slider">
                {% for item in products %}
                    <li class="slider__item">
                        <div class="shop-item">
                            <div class="shop-item__thumb">
                                <img src="{{ item.image.url }}" alt="">
                            </div>
                            <!-- end shop item thumb -->

                            <div class="shop-item__content">
                                <h1 class="shop-item__title"
                                    style="font-size: 14px">{{ item.title|truncatechars:20 }}</h1>
                                <div class="shop-item__price">{{ item.price }}</div>
                            </div>
                            <!-- end shop item content -->

                            <a href="{% url 'add_to_cart' %}?product_id={{ item.id }}" class="buy-btn"><i
                                    class="buy-btn__icon"></i>Купить</a>
                        </div>
                        <!-- end shop item -->
                    </li>
                    <!-- end slider item -->
                {% endfor %}

                <!-- end slider item -->
            </ul>
        </div>
        <!-- end best offers -->

        <header class="slider-heading cf">

            <h1 class="slider-heading__title">Продукция</h1>

        </header>

        <div class="shop-items cf">
            <div class="grid-sizer"></div>
            {% for item in products %}
                <div class="shop-item">
                    <div class="shop-item__thumb">
                        <img src="{{ item.image.url }}" alt="" style="padding: 15px;">
                    </div>
                    <!-- end shop item thumb -->

                    <div class="shop-item__content">
                        <h1 class="shop-item__title" style="font-size: 14px">{{ item.title|truncatechars:20 }}</h1>
                        <div class="shop-item__price">{{ item.price }} сом</div>
                    </div>
                    <!-- end shop item content -->

                    <a href="{% url 'add_to_cart' %}?product_id={{ item.id }}" class="buy-btn" id="ajax_cart_add"><i
                            class="buy-btn__icon"></i>Купить</a>
                </div>
                <!-- end shop item -->

            {% endfor %}
        </div>
    </div>
{% endblock %}

{% block custom_scripts %}
    <script>
        $('.buy-btn').each(function (i, obj) {
            $(obj).on('click', function (event) {
                event.preventDefault();
                var that = this;
                console.log($(that).attr('href'));

                $.ajax({
                    method: 'GET',
                    dataType: 'HTML',
                    url: $(that).attr('href'),
                    success: function (response) {
                        $('.basket').html(response);
                        {#                        $('.result').html(response);#}
                        {#var data = JSON.parse(response);#}
                        {##}
                        {#var input_form = document.createElement("inpu");#}
                        {#input_form.type = "text";#}
                        {#input_form.value = "det=" + data.result;#}
                        {#input_form.className = "form-button"; // set the CSS class#}
                        {#var block = document.getElementById('matrix_id');#}
                        {#block.append(finput_form);#}
                    },
                    error: function () {
                        console.error('Error to send requet!');
                    }
                });
            })
        });
    </script>
{% endblock %}